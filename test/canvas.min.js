window.CANVAS={},function(){function t(t,i,e){this.width=i||t.width,this.height=e||t.height,this.canvas=t,this.ctx=t.getContext("2d")}(t.prototype=Object.create(null)).type="renderer",t.prototype.render=function(t){this.ctx.clearRect(0,0,this.width,this.height),t._offset=t.getGlobalPosition(),this._render(t)},t.prototype._render=function(t){if(t.visible){var i=t._offset,i=t.getGlobalPosition(i),e=t.getLocalDimensions(),o=i.x,h=i.y,i=(t.ratio,e.width),e=e.height,s=t.texture,n=(s&&o<this.width&&0<o+i&&h<this.height&&0<h+e&&s.draw(this.ctx,o,h,i,e),t.childs);if(n){t.sortableChildren&&t.sortChildren();for(let t=0;t<n.length;t++){var r=n[t];r._offset={x:o,y:h},this._render(r)}}}},CANVAS.Renderer=t}(),function(){function t(){this.x=0,this.y=0,this.visible=!0,this.zIndex=0,this.width=10,this.height=10,this._offset={x:0,y:0,scaleX:1,scaleY:1},this.anchorX=0,this.anchorY=0,this.scaleX=1,this.scaleY=1,this.angle=0,this.parent=null,this.childId=null}(t.prototype=Object.create(null)).type=null,t.prototype.setPosition=function(t,i){this.x=t,this.y=i},t.prototype.setSize=function(t,i=t){this.width=t,this.height=i},t.prototype.setAnchor=function(t,i=t){this.anchorX=t,this.anchorY=i},t.prototype.setScale=function(t,i){this.scaleX=t,this.scaleY=i},t.prototype.getLocalDimensions=function(){var t=this.width;let i=this.height;return t*=this.scaleX,i*=this.scaleY,{width:t,height:i="sprite"==this.type&&this.preserveAspectRatio?t/this.ratio:i}},t.prototype.getLocalPosition=function(){var t=this.getLocalDimensions(),i=this.x,e=this.y;return{x:i-=t.width*this.anchorX,y:e-=t.height*this.anchorY}},t.prototype.getGlobalPosition=function(t){let i=0,e=0;if(t){var o=this.getLocalPosition();i=o.x+t.x,e=o.y+t.y}else{let t=this;for(;t;){var h=t.getLocalPosition();i+=h.x,e+=h.y,t=t.parent}}return{x:i,y:e}},t.prototype.getGlobalAngle=function(){let t=0,i=this;for(;i;)t+=i.angle,i=i.parent;return t},CANVAS.DisplayObject=t}(),function(){function t(t){let i=this,e=document.createElement("img");e.src=t,e.onload=function(){i.ratio=e.width/e.height,i.ready=!0,e=null},this.path=t,this.img=e,this.ratio=1,this.ready=!1}(t.prototype=Object.create(null)).type="texture",t.prototype.draw=function(t,i,e,o,h){this.path?t.drawImage(this.img,i,e,o,h):(t.fillStyle="#000000",t.fillRect(i,e,o,h))},CANVAS.Texture=t}(),function(){function t(t){CANVAS.DisplayObject.call(this),this.texture=t,this.preserveAspectRatio=!1,this.ratio=1}(t.prototype=Object.create(CANVAS.DisplayObject.prototype)).type="sprite",Object.defineProperty(t.prototype,"ratio",{get(){return this.texture.ratio}}),CANVAS.Sprite=t}(),function(){function t(){CANVAS.DisplayObject.call(this),this.childs=[],this.sortableChildren=!1}(t.prototype=Object.create(CANVAS.DisplayObject.prototype)).type="container",t.prototype.sortChildren=function(){var i=this.childs;i.sort(function(t,i){return t.zIndex-i.zIndex});for(let t=0;t<i.length;t++)i[t].childId=t},t.prototype.addChild=function(t){t.parent&&t.parent.removeChild(t),t.childId=this.childs.length,(t.parent=this).childs.push(t)},t.prototype.removeChild=function(t){var t=t.childId,i=this.childs[t];i.parent=null,i.childId=null,this.childs.splice(t,1)},CANVAS.Container=t}();